# Simple approach: Basic compilation test without cross-compilation 
FROM ubuntu:24.04

# Install basic development tools
RUN apt-get update && apt-get install -y \
    build-essential \
    cmake \
    ninja-build \
    git \
    && rm -rf /var/lib/apt/lists/*

# Create a minimal CMake toolchain file for basic compilation tests
RUN <<-EOF
cat > /usr/local/share/basic.cmake << 'EOF2'
# Basic toolchain that doesn't try to cross-compile
# This is just for testing the build system and basic compilation
set(CMAKE_SYSTEM_NAME Linux)
set(CMAKE_C_COMPILER gcc)
set(CMAKE_CXX_COMPILER g++)
EOF2
EOF

ENV TOOLCHAIN=/usr/local/share/basic.cmake

# Create dummy cURL libraries for the build system
RUN mkdir -p /opt/curl/include /opt/curl/build/lib && \
    touch /opt/curl/build/lib/libcurl_a.lib && \
    touch /opt/curl/build/lib/libcurl_a_debug.lib

ENV CURL_INCLUDEDIR=/opt/curl/include/
ENV CURL_LIBRARYDIR=/opt/curl/build/lib/
ENV CURL_DEBUG_LIBRARYDIR=/opt/curl/build/lib/

CMD ["/bin/bash"]